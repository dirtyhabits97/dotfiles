#!/usr/bin/env ruby

require 'fileutils'
require 'set'

HOME = ENV["HOME"]
GIT_REPO = "#{HOME}/dotfiles"

FOLDERS = Set[
  'bin',
  '.config',
  '.zsh'
]
FILES = Set[
  '.lldbinit',
  '.tmux.conf',
  '.gitconfig',
  '.zshrc'
]

folder_count = 0
files_count = 0
TO_MOVE = Dir["#{HOME}/.*"] + Dir["#{HOME}/*"] - ["#{HOME}/.", "#{HOME}/.."]
TO_MOVE.each do |fullpath| 

  filename = File.basename(fullpath)
  destination = GIT_REPO + "/" + filename 

  if FOLDERS.include? filename
    source = "#{fullpath}/."
    puts "FOLDER: Will copy #{source} to #{destination}"
    FileUtils.cp_r(source, destination)
    folder_count += 1
    next
  end

  if FILES.include? filename
    puts "FILE:   Will copy #{fullpath} to #{destination}"
    FileUtils.cp(fullpath, destination)
    files_count += 1
    next
  end
end

puts "Copied #{folder_count} folders."
puts "Copied #{files_count} files."
